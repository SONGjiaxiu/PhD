import linecache
import string
import os
import math
import time
import networkx as nx
import matplotlib.pyplot as plt
import LinkPrediction as LinkPrediction
import random
ls = os.linesep
#fname = 'dolphins.gml'


def ReadTxtData():
    'read Data'

    try:
        fdobj = open(fname,'r')
    except IOError as e:
        print "***file open error:",e
    else:
        tepstr = ''
        Result = []
        eline = fdobj.readline()
        while eline:
            line = eline.strip().split()
            #self.G.add_edge(line[0],line[1])
            tep = (line[0],line[1])
            Result.append(tep)
            eline = fdobj.readline()
    #print Result
    return Result


def DivideGmlData():
    'read Data'

    #==========Divide dataset========
    fnode = fname + '.node'
    fedge = fname + '.edge'

    try:
        fobj = open(fname,'r')
        fnobj = open(fnode,'w')
        feobj = open(fedge,'w')
    except IOError as e:
        print "***file open error:",e
    else:
        s1 = 'node'
        s2 = 'edge'
        flag = -1
        line = fobj.readline()
        while line:
            if flag == -1:
                if s1 in line:
                    flag = 1
                    fnobj.write(line)
            elif flag == 1:
                if s2 in line:
                    flag = 2
                    feobj.write(line)
                else:
                    fnobj.write(line)
            else:
                feobj.write(line)
            line = fobj.readline()
        #end while
        fobj.close()
        fnobj.close()
        feobj.close()
    #end try
    #==========End Divide dataset========


def ReadGmlData():
    'read Data'

    fedge = fname + '.edge'
    try:
        fdobj = open(fedge,'r')
    except IOError as e:
        print "***file open error:",e
    else:
        s = 'source'
        tepstr = ''
        Result = []
        eline = fdobj.readline()
        while eline:
            if s in eline:
                source = eline[11:]
                source = source.strip('\n')

                tline = fdobj.readline()
                target = tline[11:]
                target = target.strip('\n')
                tep = (source,target)
                Result.append(tep)
            eline = fdobj.readline()
    #print
    return Result




def GetGmlSubG():
    'read Data'

    Gt=nx.Graph()

    fedge = fname + '.edge'
    try:
        fdobj = open(fedge,'r')
    except IOError as e:
        print "***file open error:",e
    else:
        s = 'source' #s = 'source '
        tepstr = ''
        Result = []
        eline = fdobj.readline()
        while eline:
            if s in eline:
                source = eline[11:]
                source = source.strip('\n')

                tline = fdobj.readline()
                target = tline[11:]
                target = target.strip('\n')
                tep = (source,target)
                Result.append(tep)
            eline = fdobj.readline()
    #print Result

    Gt.add_edges_from(Result)
    graphs = nx.connected_component_subgraphs(Gt)
    SubG = graphs[0].edges()

    return SubG



def GetTxtSubG():
    'read Data'

    Gt=nx.Graph()

    try:
        fdobj = open(fname,'r')
    except IOError as e:
        print "***file open error:",e
    else:
        tepstr = ''
        Result = []
        eline = fdobj.readline()
        while eline:
            line = eline.strip().split()
            #self.G.add_edge(line[0],line[1])
            tep = (line[0],line[1])
            Result.append(tep)
            eline = fdobj.readline()
    #print Result

    Gt.add_edges_from(Result)
    graphs = nx.connected_component_subgraphs(Gt)
    SubG = graphs[0].edges()

    return SubG


def CreateGraph():
    #(1) Get edge from txt type data
    Edge = ReadTxtData()

    #(2) Get edge from gml type data
    #DivideGmlData()
    #Edge = ReadGmlData()

    #(3) Get edge of maximum component subgraph from gml type data
    #DivideGmlData()
    #Edge = GetGmlSubG()

    #(4) Get edge of maximum component subgraph from gml type data
    #Edge = GetTxtSubG()

    #netscience
    #Edge = [('344', '342'), ('344', '343'), ('345', '252'), ('345', '216'), ('345', '346'), ('345', '347'), ('346', '216'), ('346', '788'), ('346', '347'), ('346', '252'), ('346', '516'), ('347', '252'), ('347', '216'), ('342', '692'), ('342', '343'), ('343', '697'), ('343', '1145'), ('343', '219'), ('343', '1397'), ('343', '1396'), ('343', '1395'), ('343', '1394'), ('343', '221'), ('718', '717'), ('718', '716'), ('718', '715'), ('718', '695'), ('717', '716'), ('717', '715'), ('717', '695'), ('716', '715'), ('716', '695'), ('715', '695'), ('710', '69'), ('710', '709'), ('710', '97'), ('1087', '1086'), ('1087', '516'), ('1087', '1089'), ('1087', '1088'), ('1086', '516'), ('592', '591'), ('592', '590'), ('592', '589'), ('1083', '69'), ('1083', '1082'), ('1082', '69'), ('1081', '281'), ('596', '46'), ('596', '416'), ('596', '327'), ('194', '1138'), ('194', '1137'), ('194', '46'), ('194', '191'), ('194', '955'), ('194', '1136'), ('194', '1135'), ('194', '956'), ('194', '1384'), ('194', '1385'), ('1122', '1121'), ('1122', '78'), ('1123', '756'), ('1123', '78'), ('191', '46'), ('191', '193'), ('191', '192'), ('190', '33'), ('190', '507'), ('190', '508'), ('190', '509'), ('193', '46'), ('193', '192'), ('192', '46'), ('1138', '1135'), ('1138', '956'), ('276', '278'), ('276', '277'), ('277', '595'), ('277', '405'), ('277', '404'), ('277', '403'), ('277', '402'), ('277', '401'), ('277', '278'), ('278', '595'), ('278', '405'), ('278', '404'), ('278', '403'), ('278', '402'), ('278', '401'), ('279', '281'), ('279', '280'), ('279', '283'), ('279', '282'), ('279', '285'), ('279', '284'), ('1408', '416'), ('1408', '327'), ('1408', '1407'), ('1408', '1406'), ('1408', '1405'), ('1408', '1404'), ('1407', '416'), ('1407', '327'), ('1407', '1406'), ('1407', '1405'), ('1407', '1404'), ('1406', '416'), ('1406', '327'), ('1406', '1405'), ('1406', '1404'), ('1405', '416'), ('1405', '327'), ('1405', '1404'), ('1404', '416'), ('1404', '327'), ('443', '442'), ('443', '676'), ('443', '72'), ('443', '675'), ('443', '739'), ('443', '738'), ('1239', '547'), ('100', '99'), ('100', '94'), ('100', '97'), ('100', '96'), ('33', '1229'), ('33', '1228'), ('33', '133'), ('33', '132'), ('33', '131'), ('33', '134'), ('33', '34'), ('33', '1191'), ('33', '1190'), ('33', '839'), ('33', '508'), ('33', '509'), ('33', '507'), ('33', '1529'), ('33', '561'), ('33', '1295'), ('33', '464'), ('33', '562'), ('33', '489'), ('33', '488'), ('33', '485'), ('33', '1551'), ('33', '1550'), ('33', '840'), ('33', '54'), ('33', '30'), ('33', '51'), ('33', '53'), ('33', '52'), ('33', '1008'), ('33', '375'), ('33', '377'), ('33', '376'), ('32', '31'), ('32', '30'), ('908', '268'), ('908', '266'), ('908', '265'), ('908', '307'), ('30', '894'), ('30', '840'), ('30', '31'), ('30', '34'), ('30', '131'), ('30', '327'), ('30', '54'), ('30', '402'), ('34', '762'), ('34', '763'), ('34', '760'), ('34', '761'), ('34', '133'), ('34', '132'), ('34', '131'), ('34', '134'), ('34', '1191'), ('34', '1190'), ('34', '839'), ('34', '657'), ('34', '654'), ('34', '655'), ('34', '652'), ('34', '756'), ('34', '561'), ('34', '562'), ('34', '1130'), ('34', '1551'), ('34', '1550'), ('34', '840'), ('34', '54'), ('34', '865'), ('34', '53'), ('641', '78'), ('640', '638'), ('646', '853'), ('646', '78'), ('331', '151'), ('331', '330'), ('330', '151'), ('330', '1216'), ('330', '1217'), ('330', '1214'), ('330', '1215'), ('853', '78'), ('546', '547'), ('547', '55'), ('547', '56'), ('547', '1389'), ('547', '329'), ('99', '708'), ('99', '94'), ('99', '97'), ('99', '96'), ('98', '95'), ('98', '94'), ('98', '97'), ('98', '96'), ('90', '55'), ('95', '94'), ('95', '97'), ('95', '96'), ('94', '150'), ('94', '708'), ('94', '225'), ('94', '97'), ('94', '96'), ('97', '708'), ('97', '709'), ('97', '310'), ('97', '69'), ('97', '96'), ('96', '1177'), ('96', '150'), ('96', '708'), ('96', '700'), ('96', '701'), ('96', '702'), ('96', '1482'), ('96', '1481'), ('96', '225'), ('550', '121'), ('550', '548'), ('550', '549'), ('550', '1030'), ('234', '235'), ('234', '233'), ('235', '72'), ('235', '233'), ('1191', '1190'), ('1191', '54'), ('1191', '840'), ('1190', '54'), ('1190', '840'), ('1195', '1196'), ('1195', '1197'), ('1195', '78'), ('1197', '1196'), ('1197', '78'), ('1196', '78'), ('1177', '150'), ('1172', '78'), ('612', '611'), ('612', '609'), ('612', '45'), ('610', '45'), ('610', '609'), ('611', '45'), ('611', '609'), ('1178', '281'), ('1178', '150'), ('1178', '1342'), ('1283', '1145'), ('1283', '1282'), ('1283', '219'), ('1282', '1145'), ('1282', '219'), ('944', '263'), ('944', '268'), ('944', '266'), ('944', '265'), ('944', '945'), ('945', '263'), ('945', '268'), ('945', '266'), ('945', '265'), ('1470', '1315'), ('1470', '1469'), ('1470', '1468'), ('1470', '53'), ('685', '57'), ('133', '54'), ('133', '562'), ('133', '53'), ('133', '132'), ('133', '134'), ('133', '561'), ('132', '54'), ('132', '562'), ('132', '1229'), ('132', '1228'), ('132', '53'), ('132', '134'), ('132', '561'), ('131', '203'), ('136', '586'), ('136', '587'), ('136', '585'), ('136', '135'), ('136', '216'), ('136', '223'), ('136', '729'), ('134', '54'), ('134', '562'), ('134', '53'), ('134', '561'), ('490', '309'), ('490', '493'), ('490', '491'), ('490', '492'), ('490', '78'), ('491', '309'), ('493', '309'), ('405', '404'), ('405', '403'), ('405', '402'), ('405', '401'), ('404', '403'), ('404', '402'), ('404', '401'), ('403', '595'), ('403', '402'), ('403', '401'), ('402', '417'), ('402', '894'), ('402', '416'), ('402', '327'), ('402', '401'), ('402', '328'), ('934', '55'), ('934', '56'), ('1347', '1348'), ('1347', '377'), ('378', '375'), ('378', '377'), ('378', '376'), ('371', '309'), ('371', '759'), ('371', '867'), ('371', '866'), ('371', '370'), ('371', '78'), ('370', '78'), ('375', '1263'), ('375', '376'), ('375', '377'), ('375', '1295'), ('377', '1348'), ('377', '1263'), ('377', '376'), ('377', '1295'), ('376', '1263'), ('376', '1295'), ('709', '69'), ('709', '72'), ('709', '71'), ('700', '701'), ('700', '702'), ('701', '702'), ('1482', '1481'), ('80', '77'), ('80', '79'), ('80', '78'), ('586', '587'), ('586', '585'), ('587', '585'), ('587', '729'), ('1130', '657'), ('1130', '654'), ('1130', '774'), ('1137', '1136'), ('1137', '1135'), ('1137', '956'), ('1136', '1135'), ('1136', '956'), ('1135', '956'), ('589', '591'), ('589', '590'), ('589', '1180'), ('589', '1181'), ('149', '151'), ('149', '150'), ('149', '152'), ('149', '71'), ('1008', '51'), ('1005', '78'), ('515', '674'), ('515', '514'), ('515', '517'), ('515', '516'), ('514', '517'), ('514', '516'), ('517', '964'), ('517', '151'), ('517', '150'), ('517', '152'), ('517', '963'), ('517', '1341'), ('517', '127'), ('517', '225'), ('517', '1460'), ('517', '516'), ('516', '151'), ('516', '150'), ('516', '674'), ('516', '788'), ('516', '1089'), ('516', '1088'), ('516', '216'), ('516', '225'), ('591', '590'), ('591', '1180'), ('591', '1181'), ('1221', '150'), ('1221', '500'), ('590', '1181'), ('590', '1180'), ('590', '307'), ('450', '282'), ('1342', '281'), ('1342', '150'), ('1343', '281'), ('1343', '1344'), ('1344', '281'), ('1229', '1228'), ('1229', '54'), ('1228', '54'), ('977', '69'), ('977', '758'), ('977', '757'), ('977', '72'), ('656', '654'), ('656', '655'), ('656', '652'), ('657', '774'), ('657', '654'), ('657', '655'), ('657', '652'), ('654', '774'), ('654', '893'), ('654', '55'), ('654', '863'), ('654', '56'), ('654', '865'), ('654', '864'), ('654', '655'), ('654', '652'), ('654', '653'), ('655', '893'), ('655', '652'), ('655', '653'), ('186', '1162'), ('186', '184'), ('186', '185'), ('186', '1413'), ('186', '1414'), ('186', '1415'), ('653', '652'), ('184', '55'), ('184', '56'), ('184', '185'), ('1121', '78'), ('652', '893'), ('1088', '151'), ('863', '864'), ('867', '866'), ('326', '328'), ('326', '329'), ('326', '327'), ('327', '417'), ('327', '894'), ('327', '416'), ('327', '1189'), ('327', '328'), ('327', '329'), ('328', '1189'), ('328', '416'), ('328', '329'), ('329', '1389'), ('562', '54'), ('562', '53'), ('562', '561'), ('775', '774'), ('775', '892'), ('775', '776'), ('775', '756'), ('775', '761'), ('775', '764'), ('775', '765'), ('774', '776'), ('774', '761'), ('203', '301'), ('203', '302'), ('203', '303'), ('203', '317'), ('203', '316'), ('776', '761'), ('771', '773'), ('771', '772'), ('771', '770'), ('771', '126'), ('771', '127'), ('770', '772'), ('770', '773'), ('770', '126'), ('770', '127'), ('773', '772'), ('773', '126'), ('773', '127'), ('772', '126'), ('772', '127'), ('77', '79'), ('77', '78'), ('72', '757'), ('72', '758'), ('72', '71'), ('72', '70'), ('72', '69'), ('72', '738'), ('71', '151'), ('71', '150'), ('71', '157'), ('71', '158'), ('71', '70'), ('71', '737'), ('71', '736'), ('71', '69'), ('70', '69'), ('79', '78'), ('78', '46'), ('78', '281'), ('78', '308'), ('78', '309'), ('78', '756'), ('78', '759'), ('78', '305'), ('78', '306'), ('78', '307'), ('78', '121'), ('1041', '216'), ('1041', '224'), ('1041', '218'), ('1040', '308'), ('1040', '1039'), ('1145', '697'), ('1145', '1396'), ('1145', '219'), ('1145', '1397'), ('1145', '1560'), ('1145', '1561'), ('1145', '1395'), ('1145', '1394'), ('1145', '221'), ('693', '698'), ('693', '696'), ('693', '697'), ('693', '694'), ('693', '695'), ('696', '698'), ('696', '697'), ('696', '694'), ('696', '695'), ('697', '694'), ('697', '698'), ('697', '695'), ('697', '219'), ('697', '1397'), ('697', '1396'), ('697', '1395'), ('697', '1394'), ('694', '698'), ('694', '695'), ('695', '698'), ('1549', '308'), ('1469', '1315'), ('1469', '53'), ('1469', '1468'), ('1468', '1315'), ('1468', '53'), ('548', '121'), ('548', '549'), ('549', '121'), ('1461', '55'), ('1461', '56'), ('1460', '151'), ('1460', '127'), ('1316', '1315'), ('1316', '1314'), ('1316', '1313'), ('1316', '1312'), ('1315', '1314'), ('1315', '1313'), ('1315', '1312'), ('1315', '53'), ('1314', '1313'), ('1314', '1312'), ('1313', '1312'), ('120', '121'), ('121', '764'), ('121', '765'), ('121', '1255'), ('121', '1030'), ('764', '892'), ('764', '756'), ('764', '761'), ('764', '765'), ('764', '1255'), ('126', '127'), ('126', '128'), ('127', '151'), ('127', '1022'), ('127', '1023'), ('127', '128'), ('127', '1021'), ('128', '1021'), ('128', '1023'), ('128', '1022'), ('765', '892'), ('765', '756'), ('765', '761'), ('765', '1255'), ('1384', '1385'), ('499', '303'), ('310', '69'), ('317', '301'), ('317', '316'), ('316', '638'), ('316', '301'), ('316', '639'), ('316', '162'), ('839', '54'), ('788', '216'), ('576', '281'), ('576', '574'), ('575', '281'), ('575', '574'), ('574', '281'), ('574', '283'), ('252', '216'), ('252', '217'), ('252', '218'), ('252', '251'), ('69', '758'), ('69', '757'), ('251', '216'), ('251', '218'), ('251', '217'), ('1162', '1163'), ('1162', '114'), ('1162', '1413'), ('1162', '1414'), ('1162', '1415'), ('1039', '308'), ('737', '736'), ('502', '503'), ('502', '500'), ('502', '501'), ('503', '500'), ('500', '150'), ('500', '501'), ('1216', '1217'), ('1216', '1214'), ('1216', '1215'), ('1217', '1214'), ('1217', '1215'), ('1214', '1215'), ('638', '639'), ('638', '463'), ('638', '301'), ('638', '162'), ('464', '465'), ('464', '466'), ('466', '465'), ('461', '460'), ('461', '463'), ('461', '462'), ('460', '463'), ('460', '462'), ('463', '301'), ('463', '462'), ('162', '301'), ('162', '163'), ('162', '639'), ('964', '151'), ('964', '963'), ('963', '151'), ('1451', '281'), ('1451', '283'), ('1452', '216'), ('892', '761'), ('892', '756'), ('893', '55'), ('893', '56'), ('216', '217'), ('216', '48'), ('216', '218'), ('216', '219'), ('216', '224'), ('216', '223'), ('216', '222'), ('216', '221'), ('216', '220'), ('217', '218'), ('217', '48'), ('762', '763'), ('762', '761'), ('762', '756'), ('763', '761'), ('763', '756'), ('760', '756'), ('761', '756'), ('218', '48'), ('218', '219'), ('218', '224'), ('218', '220'), ('219', '1394'), ('219', '1396'), ('219', '473'), ('219', '1397'), ('219', '1560'), ('219', '1561'), ('219', '1395'), ('219', '224'), ('219', '222'), ('219', '221'), ('219', '220'), ('281', '150'), ('281', '280'), ('281', '283'), ('281', '282'), ('281', '285'), ('281', '284'), ('280', '283'), ('280', '282'), ('280', '285'), ('280', '284'), ('283', '282'), ('283', '285'), ('283', '284'), ('282', '285'), ('282', '284'), ('285', '284'), ('1091', '472'), ('1091', '473'), ('1091', '984'), ('1092', '473'), ('1092', '984'), ('1092', '985'), ('675', '676'), ('676', '1556'), ('676', '1557'), ('676', '1558'), ('263', '262'), ('263', '267'), ('263', '266'), ('263', '265'), ('263', '264'), ('263', '269'), ('263', '268'), ('262', '267'), ('262', '266'), ('262', '265'), ('262', '264'), ('262', '269'), ('262', '268'), ('267', '266'), ('267', '265'), ('267', '264'), ('267', '269'), ('267', '268'), ('266', '307'), ('266', '265'), ('266', '264'), ('266', '269'), ('266', '268'), ('265', '307'), ('265', '264'), ('265', '269'), ('265', '268'), ('264', '269'), ('264', '268'), ('269', '268'), ('268', '307'), ('1551', '1550'), ('1550', '54'), ('58', '57'), ('58', '51'), ('1557', '1558'), ('1557', '1556'), ('1556', '1558'), ('55', '56'), ('55', '51'), ('57', '51'), ('56', '51'), ('51', '54'), ('51', '53'), ('51', '52'), ('50', '47'), ('50', '48'), ('50', '49'), ('53', '1025'), ('53', '1024'), ('53', '54'), ('53', '561'), ('53', '52'), ('52', '54'), ('54', '840'), ('54', '489'), ('54', '488'), ('54', '1529'), ('54', '561'), ('1413', '1414'), ('1413', '1415'), ('1414', '1415'), ('1416', '1026'), ('1416', '303'), ('1416', '1417'), ('1417', '1026'), ('1417', '303'), ('983', '986'), ('983', '984'), ('983', '985'), ('986', '984'), ('984', '985'), ('984', '472'), ('984', '473'), ('985', '473'), ('114', '113'), ('114', '1163'), ('429', '428'), ('428', '46'), ('428', '1362'), ('428', '1361'), ('1397', '1396'), ('1397', '1395'), ('1397', '1394'), ('1396', '1395'), ('1396', '1394'), ('1395', '1394'), ('308', '309'), ('308', '305'), ('308', '306'), ('308', '307'), ('309', '305'), ('301', '151'), ('301', '150'), ('301', '302'), ('301', '303'), ('301', '304'), ('301', '639'), ('302', '303'), ('302', '304'), ('302', '1182'), ('303', '1026'), ('305', '306'), ('305', '307'), ('306', '307'), ('757', '758'), ('757', '756'), ('756', '758'), ('756', '759'), ('507', '508'), ('507', '509'), ('225', '151'), ('225', '150'), ('224', '220'), ('222', '473'), ('222', '221'), ('222', '220'), ('221', '220'), ('1025', '1024'), ('1027', '1026'), ('1021', '1023'), ('1021', '1022'), ('1023', '1022'), ('1180', '1181'), ('151', '150'), ('157', '158'), ('609', '45'), ('48', '49'), ('48', '47'), ('49', '47'), ('46', '44'), ('46', '45'), ('46', '1362'), ('46', '1363'), ('46', '1361'), ('44', '45'), ('955', '956'), ('1560', '1561'), ('508', '509'), ('489', '488'), ('472', '473'), ('472', '474'), ('473', '474'), ('1362', '1361')]
    #Dolphins
    #Edge = [('8','3'),('9','5'),('9','6'),('10','0'),('10','2'),('13','5'),('13','6'),('13','9'),('14','0'),('14','3'),('15','0'),('16','14'),('17','1'),('17','6'),('17','9'),('17','13'),('18','15'),('19','1'),('19','7'),('20','8'),('20','16'),('20','18'),('21','18'),('22','17'),('24','14'),('24','15'),('24','18'),('25','17'),('26','1'),('26','25'),('27','1'),('27','7'),('27','17'),('27','25'),('27','26'),('28','1'),('28','8'),('28','20'),('29','10'),('29','18'),('29','21'),('29','24'),('30','7'),('30','19'),('30','28'),('31','17'),('32','9'),('32','13'),('33','12'),('33','14'),('33','16'),('33','21'),('34','14'),('34','33'),('35','29'),('36','1'),('36','20'),('36','23'),('37','8'),('37','14'),('37','16'),('37','21'),('37','33'),('37','34'),('37','36'),('38','14'),('38','16'),('38','20'),('38','33'),('39','36'),('40','0'),('40','7'),('40','14'),('40','15'),('40','33'),('40','36'),('40','37'),('41','1'),('41','9'),('41','13'),('42','0'),('42','2'),('42','10'),('42','30'),('43','14'),('43','29'),('43','33'),('43','37'),('43','38'),('44','2'),('44','20'),('44','34'),('44','38'),('45','8'),('45','15'),('45','18'),('45','21'),('45','23'),('45','24'),('45','29'),('45','37'),('46','43'),('47','0'),('47','10'),('47','20'),('47','28'),('47','30'),('47','42'),('49','34'),('49','46'),('50','14'),('50','16'),('50','20'),('50','33'),('50','42'),('50','45'),('51','4'),('51','11'),('51','18'),('51','21'),('51','23'),('51','24'),('51','29'),('51','45'),('51','50'),('52','14'),('52','29'),('52','38'),('52','40'),('53','43'),('54','1'),('54','6'),('54','7'),('54','13'),('54','19'),('54','41'),('55','15'),('55','51'),('56','5'),('56','6'),('57','5'),('57','6'),('57','9'),('57','13'),('57','17'),('57','39'),('57','41'),('57','48'),('57','54'),('58','38'),('59','3'),('59','8'),('59','15'),('59','36'),('59','45'),('60','32'),('61','2'),('61','37'),('61','53')]
    #Edge = [('1', '0'), ('2', '0'), ('3', '0'), ('3', '2'), ('4', '0'), ('5', '0'), ('6', '0'), ('7', '0'), ('8', '0'), ('9', '0'), ('11', '10'), ('11', '3'), ('11', '2'), ('11', '0'), ('12', '11'), ('13', '11'), ('14', '11'), ('15', '11'), ('17', '16'), ('18', '16'), ('18', '17'), ('19', '16'), ('19', '17'), ('19', '18'), ('20', '16'), ('20', '17'), ('20', '18'), ('20', '19'), ('21', '16'), ('21', '17'), ('21', '18'), ('21', '19'), ('21', '20'), ('22', '16'), ('22', '17'), ('22', '18'), ('22', '19'), ('22', '20'), ('22', '21'), ('23', '16'), ('23', '17'), ('23', '18'), ('23', '19'), ('23', '20'), ('23', '21'), ('23', '22'), ('23', '12'), ('23', '11'), ('24', '23'), ('24', '11'), ('25', '24'), ('25', '23'), ('25', '11'), ('26', '24'), ('26', '11'), ('26', '16'), ('26', '25'), ('27', '11'), ('27', '23'), ('27', '25'), ('27', '24'), ('27', '26'), ('28', '11'), ('28', '27'), ('29', '23'), ('29', '27'), ('29', '11'), ('30', '23'), ('31', '30'), ('31', '11'), ('31', '23'), ('31', '27'), ('32', '11'), ('33', '11'), ('33', '27'), ('34', '11'), ('34', '29'), ('35', '11'), ('35', '34'), ('35', '29'), ('36', '34'), ('36', '35'), ('36', '11'), ('36', '29'), ('37', '34'), ('37', '35'), ('37', '36'), ('37', '11'), ('37', '29'), ('38', '34'), ('38', '35'), ('38', '36'), ('38', '37'), ('38', '11'), ('38', '29'), ('39', '25'), ('40', '25'), ('41', '24'), ('41', '25'), ('42', '41'), ('42', '25'), ('42', '24'), ('43', '11'), ('43', '26'), ('43', '27'), ('44', '28'), ('44', '11'), ('45', '28'), ('47', '46'), ('48', '47'), ('48', '25'), ('48', '27'), ('48', '11'), ('49', '26'), ('49', '11'), ('50', '49'), ('50', '24'), ('51', '49'), ('51', '26'), ('51', '11'), ('52', '51'), ('52', '39'), ('53', '51'), ('54', '51'), ('54', '49'), ('54', '26'), ('55', '51'), ('55', '49'), ('55', '39'), ('55', '54'), ('55', '26'), ('55', '11'), ('55', '16'), ('55', '25'), ('55', '41'), ('55', '48'), ('56', '49'), ('56', '55'), ('57', '55'), ('57', '41'), ('57', '48'), ('58', '55'), ('58', '48'), ('58', '27'), ('58', '57'), ('58', '11'), ('59', '58'), ('59', '55'), ('59', '48'), ('59', '57'), ('60', '48'), ('60', '58'), ('60', '59'), ('61', '48'), ('61', '58'), ('61', '60'), ('61', '59'), ('61', '57'), ('61', '55'), ('62', '55'), ('62', '58'), ('62', '59'), ('62', '48'), ('62', '57'), ('62', '41'), ('62', '61'), ('62', '60'), ('63', '59'), ('63', '48'), ('63', '62'), ('63', '57'), ('63', '58'), ('63', '61'), ('63', '60'), ('63', '55'), ('64', '55'), ('64', '62'), ('64', '48'), ('64', '63'), ('64', '58'), ('64', '61'), ('64', '60'), ('64', '59'), ('64', '57'), ('64', '11'), ('65', '63'), ('65', '64'), ('65', '48'), ('65', '62'), ('65', '58'), ('65', '61'), ('65', '60'), ('65', '59'), ('65', '57'), ('65', '55'), ('66', '64'), ('66', '58'), ('66', '59'), ('66', '62'), ('66', '65'), ('66', '48'), ('66', '63'), ('66', '61'), ('66', '60'), ('67', '57'), ('68', '25'), ('68', '11'), ('68', '24'), ('68', '27'), ('68', '48'), ('68', '41'), ('69', '25'), ('69', '68'), ('69', '11'), ('69', '24'), ('69', '27'), ('69', '48'), ('69', '41'), ('70', '25'), ('70', '69'), ('70', '68'), ('70', '11'), ('70', '24'), ('70', '27'), ('70', '41'), ('70', '58'), ('71', '27'), ('71', '69'), ('71', '68'), ('71', '70'), ('71', '11'), ('71', '48'), ('71', '41'), ('71', '25'), ('72', '26'), ('72', '27'), ('72', '11'), ('73', '48'), ('74', '48'), ('74', '73'), ('75', '69'), ('75', '68'), ('75', '25'), ('75', '48'), ('75', '41'), ('75', '70'), ('75', '71'), ('76', '64'), ('76', '65'), ('76', '66'), ('76', '63'), ('76', '62'), ('76', '48'), ('76', '58')]
    #shen huawei:
    #Edge = [('1', '2'), ('1', '3'), ('1', '4'),('1', '5'), ('1', '6'), ('2', '3'), ('2', '4'), ('2', '5'), ('2', '6'),  ('3', '4'),('3', '5'),('3', '6'),('3', '7'),('3', '8'),('3', '13'), ('4', '5'), ('4', '6'), ('4', '23'), ('5', '22'),  ('7', '8'), ('7', '9'),('7', '10'), ('7', '12'),('7', '13'), ('8', '9'), ('8', '10'), ('8', '11'), ('8', '12'), ('8', '13'), ('9', '10'), ('10', '13'),('10', '14'),('10', '15'),('10', '16'),('10', '17'), ('11', '12'), ('11', '16'), ('11', '17'),('12', '13'),  ('12', '14'), ('12', '16'), ('12', '17'), ('14', '15'), ('14', '16'), ('14', '17'), ('15', '16'),('15', '17'), ('16', '17'), ('17', '18'),('17', '19'), ('18', '19'),('18', '20'),('18', '21'),('18', '22'),('18', '23'), ('19', '22'),('19', '23'), ('20', '21'),('20', '22'),('20', '23'),('21', '23'), ('22', '23')]
    #Louvain
    #Edge = [('0', '2'),('0', '3'),('0', '4'),('0', '5'),('1', '2'),('1', '4'),('1', '7'),('2', '4'),('2', '5'),('2', '6'),('3', '7'),('4', '10'),('5', '7'),('5', '11'),('6', '7'),('6', '11'),('8', '9'),('8', '10'),('8', '11'),('8', '14'),('8', '15'),('9', '12'),('9', '14'),('10', '11'),('10', '12'),('10', '13'),('10', '14'),('11', '13')]

    #n*c: 3*10
    """
    Edge = [('0', '1'), ('0', '2'), ('1', '2'), ('3', '4'), ('3', '5'), ('4', '5'), ('6', '7'), ('6', '8'), ('7', '8'),
        ('9', '10'), ('9', '11'), ('10', '11'), ('12', '13'), ('12', '14'), ('13', '14'), ('15', '16'), ('15', '17'),
        ('16', '17'), ('18', '19'), ('18', '20'), ('19', '20'), ('21', '22'), ('21', '23'), ('22', '23'), ('24', '25'),
        ('24', '26'), ('25', '26'), ('27', '28'), ('27', '29'), ('28', '29'), ('2', '3'), ('5', '6'), ('8', '9'),
        ('11', '12'), ('14', '15'), ('17', '18'), ('20', '21'), ('23', '24'), ('26', '27'), ('29', '0')]

    #n*c: 6*6
    Edge = [('0', '1'), ('0', '2'), ('0', '3'), ('0', '4'), ('0', '5'), ('1', '2'), ('1', '3'), ('1', '4'), ('1', '5'),
            ('2', '3'), ('2', '4'), ('2', '5'), ('3', '4'), ('3', '5'), ('4', '5'), ('6', '7'), ('6', '8'), ('6', '9'),
            ('6', '10'), ('6', '11'), ('7', '8'), ('7', '9'), ('7', '10'), ('7', '11'), ('8', '9'), ('8', '10'),
            ('8', '11'), ('9', '10'), ('9', '11'), ('10', '11'), ('12', '13'), ('12', '14'), ('12', '15'), ('12', '16'),
            ('12', '17'), ('13', '14'), ('13', '15'), ('13', '16'), ('13', '17'), ('14', '15'), ('14', '16'), ('14', '17'),
            ('15', '16'), ('15', '17'), ('16', '17'), ('18', '19'), ('18', '20'), ('18', '21'), ('18', '22'), ('18', '23'),
            ('19', '20'), ('19', '21'), ('19', '22'), ('19', '23'), ('20', '21'), ('20', '22'), ('20', '23'), ('21', '22'),
            ('21', '23'), ('22', '23'), ('24', '25'), ('24', '26'), ('24', '27'), ('24', '28'), ('24', '29'), ('25', '26'),
            ('25', '27'), ('25', '28'), ('25', '29'), ('26', '27'), ('26', '28'), ('26', '29'), ('27', '28'), ('27', '29'),
            ('28', '29'), ('30', '31'), ('30', '32'), ('30', '33'), ('30', '34'), ('30', '35'), ('31', '32'), ('31', '33'),
            ('31', '34'), ('31', '35'), ('32', '33'), ('32', '34'), ('32', '35'), ('33', '34'), ('33', '35'), ('34', '35'),
            ('5', '6'), ('11', '12'), ('17', '18'), ('23', '24'), ('29', '30')]

    #n*c: 4*30
    Edge = [('0', '1'), ('0', '2'), ('0', '3'), ('1', '2'), ('1', '3'), ('2', '3'), ('4', '5'), ('4', '6'), ('4', '7'),
            ('5', '6'), ('5', '7'), ('6', '7'), ('8', '9'), ('8', '10'), ('8', '11'), ('9', '10'), ('9', '11'), ('10', '11'),
            ('12', '13'), ('12', '14'), ('12', '15'), ('13', '14'), ('13', '15'), ('14', '15'), ('16', '17'), ('16', '18'),
            ('16', '19'), ('17', '18'), ('17', '19'), ('18', '19'), ('20', '21'), ('20', '22'), ('20', '23'), ('21', '22'),
            ('21', '23'), ('22', '23'), ('24', '25'), ('24', '26'), ('24', '27'), ('25', '26'), ('25', '27'), ('26', '27'),
            ('28', '29'), ('28', '30'), ('28', '31'), ('29', '30'), ('29', '31'), ('30', '31'), ('32', '33'), ('32', '34'), ('32', '35'), ('33', '34'), ('33', '35'), ('34', '35'), ('36', '37'), ('36', '38'), ('36', '39'), ('37', '38'), ('37', '39'),
            ('38', '39'), ('40', '41'), ('40', '42'), ('40', '43'), ('41', '42'), ('41', '43'), ('42', '43'), ('44', '45'),
            ('44', '46'), ('44', '47'), ('45', '46'), ('45', '47'), ('46', '47'), ('48', '49'), ('48', '50'), ('48', '51'),
            ('49', '50'), ('49', '51'), ('50', '51'), ('52', '53'), ('52', '54'), ('52', '55'), ('53', '54'), ('53', '55'),
            ('54', '55'), ('56', '57'), ('56', '58'), ('56', '59'), ('57', '58'), ('57', '59'), ('58', '59'), ('60', '61'),
            ('60', '62'), ('60', '63'), ('61', '62'), ('61', '63'), ('62', '63'), ('64', '65'), ('64', '66'), ('64', '67'),
            ('65', '66'), ('65', '67'), ('66', '67'), ('68', '69'), ('68', '70'), ('68', '71'), ('69', '70'), ('69', '71'),
            ('70', '71'), ('72', '73'), ('72', '74'), ('72', '75'), ('73', '74'), ('73', '75'), ('74', '75'), ('76', '77'),
            ('76', '78'), ('76', '79'), ('77', '78'), ('77', '79'), ('78', '79'), ('80', '81'), ('80', '82'), ('80', '83'),
            ('81', '82'), ('81', '83'), ('82', '83'), ('84', '85'), ('84', '86'), ('84', '87'), ('85', '86'), ('85', '87'),
            ('86', '87'), ('88', '89'), ('88', '90'), ('88', '91'), ('89', '90'), ('89', '91'), ('90', '91'), ('92', '93'),
            ('92', '94'), ('92', '95'), ('93', '94'), ('93', '95'), ('94', '95'), ('96', '97'), ('96', '98'), ('96', '99'),
            ('97', '98'), ('97', '99'), ('98', '99'), ('100', '101'), ('100', '102'), ('100', '103'), ('101', '102'),
            ('101', '103'), ('102', '103'), ('104', '105'), ('104', '106'), ('104', '107'), ('105', '106'), ('105', '107'),
            ('106', '107'), ('108', '109'), ('108', '110'), ('108', '111'), ('109', '110'), ('109', '111'), ('110', '111'),
            ('112', '113'), ('112', '114'), ('112', '115'), ('113', '114'), ('113', '115'), ('114', '115'), ('116', '117'),
            ('116', '118'), ('116', '119'), ('117', '118'), ('117', '119'), ('118', '119'), ('3', '4'),('7', '8'), ('11', '12'), ('15', '16'), ('19', '20'),
            ('23', '24'), ('27', '28'), ('31', '32'), ('35', '36'), ('39', '40'), ('43', '44'), ('47', '48'), ('51', '52'),
            ('55', '56'), ('59', '60'), ('63', '64'), ('67', '68'), ('71', '72'), ('75', '76'), ('79', '80'), ('83', '84'),
            ('87', '88'), ('91', '92'), ('95', '96'), ('99', '100'), ('103', '104'), ('107', '108'), ('111', '112'),
            ('115', '116'), ('119', '0')]
    """
    return Edge
#************************************************************************





#************************************************************************
def drawcomgraph(HG, DrawGraph):
    #Draw the graph
    #print HG.nodes()
    pos=nx.spring_layout(HG)
    nx.draw_networkx_edges(HG, pos, alpha=0.4)
    nx.draw_networkx_labels(HG, pos, font_size=6, font_family='sans-serif')
    i = 0
    colorList = ['SeaGreen','yellow','brown','pink','purple','blue','green','Salmon','red','c','magenta','orange','white','black','y','skyblue','GreenYellow','cyan']#,'aqua'
    for key in DrawGraph.keys():
        nx.draw_networkx_nodes(HG, pos, nodelist=DrawGraph[key], node_size=100,node_color=colorList[i%len(colorList)])
        i = i + 1

    plt.title("Network Community Analysis")
    plt.show()

#************************************************************************

if __name__ == '__main__':
    #Create Network
    #g = nx.karate_club_graph()

    fname = 'F:/Link_Prediction_Code/Dataset/celegansneural.gml'
    G = nx.Graph()
    H = nx.read_gml(fname)
    Edges_Set = H.edges(data=True)
    print Edges_Set
    for edge in Edges_Set:
        G.add_edge((edge[0]), (edge[1]), weight=float( edge[2]['value'] )  )
    #END


    '''
    fname = 'F:/Link_Prediction_Code/Dataset/USAir.txt'
    G = nx.Graph()
    try:
        fdobj = open(fname,'r')
    except IOError as e:
        print "***file open error:",e
    else:
        tepstr = ''
        Result = []
        eline = fdobj.readline()
        while eline:
            line = eline.strip().split()
            #self.G.add_edge(line[0],line[1])
            G.add_edge(string.atoi(line[0]), string.atoi(line[1]), weight=string.atof(line[2])  )
            eline = fdobj.readline()
    #print Result
    '''


    #=======Split data into training data and test data================
    print "len(G.nodes()):", G.number_of_nodes()
    print "len(G.edges()):", G.number_of_edges()
    Edges_Set = G.edges(data=True)
    Edge_Num = len(Edges_Set)
    Top_L = int(Edge_Num*0.08)
    print Top_L
    Probe_Set = []

    while len(Probe_Set) < Top_L:
        Tep_Edge = []
        Del = random.randint(0, Edge_Num-1)
        #print Del, Edges_Set[Del]
        Tep_Edge.append(Edges_Set[Del])

        ##********Split data into training data and test data*******
        if G.has_edge( Edges_Set[Del][0], Edges_Set[Del][1] ):
            G.remove_edge(Edges_Set[Del][0], Edges_Set[Del][1])
            if nx.is_connected(G) != True:
                G.add_edges_from(Tep_Edge)
            else:
                Probe_Set.append((Edges_Set[Del][0],Edges_Set[Del][1]))
        else:
            print "ERROR"

    print "len(Probe_Set):", len(Probe_Set), Top_L
    #END


    '''
    #####*********Statistic attributes of graphs*************
    print "*Statistic attributes of graphs:"
    print "N", nx.number_of_nodes(G)
    print "M", nx.number_of_edges(G)
    print "C", nx.average_clustering(G)
    print "Cw", nx.average_clustering(G, weight='weight')
    print "<d>", nx.average_shortest_path_length(G)
    print "r", nx.degree_assortativity_coefficient(G)
    #print nx.density(G)
    #print nx.transitivity(G)
    degree_list = list(G.degree_iter())
    #print degree_list
    avg_degree_1 = 0.0
    avg_degree_2 = 0.0
    for node in degree_list:
        avg_degree_1 = avg_degree_1 + node[1]
        avg_degree_2 = avg_degree_2 + node[1]*node[1]
    avg_degree = avg_degree_1/len(degree_list)
    avg_degree_square = (avg_degree_2/len(degree_list)) / (avg_degree*avg_degree)
    print "<k>", avg_degree
    print "H", avg_degree_square
    '''


    #print "============Drift_Prediction_Experiment==============================="
    #G = LinkPrediction.Position_Drift.Graph_Spatial_Temporal_Dynamics(G, 3)  #Spatial_Temporal influence based node position drift.
    #Prediction_Experiment(G, Predictor, Probe_Set, Top_L, 3.0) #Top_K, Deleted_Ratio

    LinkPrediction.Drift_Prediction_Experiment(G, 'WCN', Probe_Set, Top_L, G.number_of_edges())




